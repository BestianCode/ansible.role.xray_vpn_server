---
#
# This role should be used together with ansible-galaxy collection bestiancode.nginx_ssl to manage SSL certificates
# Galaxy: https://galaxy.ansible.com/ui/repo/published/bestiancode/nginx_ssl/
# GitHub: https://github.com/BestianCode/ansible.role.signal_proxy
#
# ansible-galaxy collection install bestiancode.nginx_ssl
#
# Here's a sample `requirements.yml` file:
#
# ```yaml
# collections:
#   - name: bestiancode.sysadmin
#   - name: bestiancode.nginx_ssl
#
# roles:
#   - name: bestiancode.xray_vpn_server
# ```

#
# Xray VPN Server connection strings will be provided as the latest step of the ansible role
#
# If you use port 443, you have to disable catching of default port 443 by Nginx
# catch_default_443: false
# if not 443, you can use default catching
# catch_default_443: true
#
xray_dns_name: "{{ ansible_host }}"
xray_ssl_name: "{{ xray_dns_name }}"

# Main inbound port (optional)
# If not defined, a minimal inbound will be created on 127.0.0.1:65501 (tcp, no security)
# This is useful when you only want to use extra_inbounds
# xray_port: 8443

xray_path: /maps

xray_ver: v25.6.8
xray_url: "https://github.com/XTLS/Xray-core/releases/download/{{xray_ver}}"

xray_folder: /usr/local/xray

xray_user: xray
xray_group: xray

xray_protocol: vless

xray_security: tls
xray_network_type: ws

# Don't use default UIDs, for a security reasons! Generate your own!
#
# Use the following command to generate a new UUID:
#
# uuidgen
#
xray_users:
  - { uid: "E6AA699D-8642-4767-8C98-DB93F958A48B", name: "John" }
  - { uid: "39ADD62B-B607-4C56-866F-364F4056EF83", name: "Vika" }
  - { uid: "A1B2C3D4-E5F6-7890-1234-56789ABCDEF0", name: "Michael" }
  - { uid: "B2C3D4E5-F678-9012-3456-789ABCDE1234", name: "Sophia" }
  - { uid: "C3D4E5F6-7890-1234-5678-9ABCDEF12345", name: "David" }
  - { uid: "D4E5F678-9012-3456-789A-BCDEF1234567", name: "Emma" }
  - { uid: "E5F67890-1234-5678-9ABC-DEF123456789", name: "James" }
  - { uid: "F6789012-3456-789A-BCDE-F123456789AB", name: "Olivia" }
  - { uid: "67890123-4567-89AB-CDEF-123456789ABC", name: "Daniel" }
  - { uid: "78901234-5678-9ABC-DEF1-23456789ABCD", name: "Ava" }

# Additional inbounds (optional)
# You can define multiple extra inbound configurations
#
# Supported network types: ws, tcp, grpc
# Supported security types: none, tls, reality
#
# Example:
# xray_extra_inbounds:
#   # WebSocket with no TLS (behind reverse proxy)
#   - port: 8444
#     listen: 127.0.0.1        # default: 127.0.0.1
#     dns_name: "proxy1.example.com"  # default: xray_dns_name
#     external_port: 443       # external port for client connections (default: port)
#     external_dns_name: "vpn.example.com"  # external DNS for client connections (default: dns_name)
#     network: ws              # default: xray_network_type (ws)
#     security: none           # default: none
#     proxy_protocol: true     # default: false
#     path: /maps              # default: xray_path
#     users: "{{ xray_users }}"  # default: xray_users - can specify custom list
#
#   # WebSocket with TLS (custom certificates)
#   - port: 8445
#     listen: 0.0.0.0
#     dns_name: "proxy2.example.com"
#     network: ws
#     security: tls
#     path: /custom
#     cert_file: "/etc/ssl/certs/custom.pem"      # default: {{ xray_folder }}/etc/cert.pem
#     key_file: "/etc/ssl/private/custom.key"     # default: {{ xray_folder }}/etc/key.pem
#     users:                   # custom user list for this inbound only
#       - { uid: "CUSTOM-UUID-1", name: "SpecialUser1" }
#       - { uid: "CUSTOM-UUID-2", name: "SpecialUser2" }
#
#   # VLESS-XTLS-Reality (recommended for anti-censorship)
#   # Using HAProxy on port 443 to proxy to internal port 44444
#   - port: 44444
#     listen: 127.0.0.1
#     external_port: 443       # HAProxy listens on 443
#     external_dns_name: "vpn.example.com"  # public DNS name
#     network: tcp
#     security: reality
#     flow: xtls-rprx-vision   # required for reality
#     reality_dest: "www.google.com:443"  # SNI destination
#     reality_server_names:
#       - "www.google.com"
#       - "google.com"
#     reality_private_key: "YOUR_PRIVATE_KEY"  # generate with: xray x25519
#     reality_public_key: "YOUR_PUBLIC_KEY"    # for client connection strings
#     reality_short_ids:       # generate with: openssl rand -hex 4
#       - ""
#       - "0123456789abcdef"
#     users: "{{ xray_users }}"
#
xray_extra_inbounds: []
